# ğŸ“¦ Cloudflare Pages éƒ¨ç½²é…ç½®æ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

æ‚¨çš„ **PDFToolkit** é¡¹ç›®å·²å®Œå…¨é…ç½®å¥½ï¼Œå¯ä»¥éƒ¨ç½²åˆ° Cloudflare Pagesã€‚

---

## ğŸ“ æ–°å¢çš„é…ç½®æ–‡ä»¶

### 1. **æ ¸å¿ƒé…ç½®æ–‡ä»¶**

#### `wrangler.toml`
- Cloudflare Pages çš„ä¸»é…ç½®æ–‡ä»¶
- å®šä¹‰æ„å»ºå‘½ä»¤ã€è¾“å‡ºç›®å½•
- é…ç½®å®‰å…¨ Headers å’Œç¼“å­˜ç­–ç•¥

#### `public/_headers`
- HTTP Headers é…ç½®
- å®‰å…¨å¤´ï¼šCORSã€XSS é˜²æŠ¤ã€Frame ä¿æŠ¤
- ç¼“å­˜ç­–ç•¥ï¼šé™æ€èµ„æº 1 å¹´ç¼“å­˜
- éšç§ä¿æŠ¤ï¼šç¦ç”¨ FLoC

#### `public/_redirects`
- 404 é”™è¯¯å¤„ç†
- å°†æœªæ‰¾åˆ°çš„é¡µé¢é‡å®šå‘åˆ°é¦–é¡µ

---

### 2. **Node.js ç‰ˆæœ¬ç®¡ç†**

#### `.nvmrc`
```
22
```

#### `.node-version`
```
22.16.0
```

è¿™äº›æ–‡ä»¶ç¡®ä¿ Cloudflare Pages ä½¿ç”¨æ­£ç¡®çš„ Node.js ç‰ˆæœ¬ï¼ˆ22.xï¼‰ã€‚

---

### 3. **è‡ªåŠ¨åŒ–è„šæœ¬**

#### `scripts/pre-deploy-check.js`
- éƒ¨ç½²å‰éªŒè¯è„šæœ¬
- æ£€æŸ¥ 10 ä¸ªå…³é”®é¡¹ï¼š
  - âœ… æ„å»ºè¾“å‡ºï¼ˆdist/ï¼‰
  - âœ… ç´¢å¼•æ–‡ä»¶ï¼ˆindex.htmlï¼‰
  - âœ… åŒ…é…ç½®ï¼ˆpackage.jsonï¼‰
  - âœ… Cloudflare é…ç½®
  - âœ… Headers æ–‡ä»¶
  - âœ… Redirects æ–‡ä»¶
  - âœ… Node.js ç‰ˆæœ¬æ–‡ä»¶
  - âœ… é™æ€èµ„æº
  - âœ… å›½é™…åŒ–å±æ€§
  - âœ… å“ç‰Œåç§°

è¿è¡Œï¼š`npm run deploy:check`

---

### 4. **GitHub Actions å·¥ä½œæµï¼ˆå¯é€‰ï¼‰**

#### `.github/workflows/cloudflare-pages.yml`
- è‡ªåŠ¨éƒ¨ç½²åˆ° Cloudflare Pages
- è§¦å‘æ¡ä»¶ï¼šæ¨é€åˆ° main åˆ†æ”¯æˆ– Pull Request
- è‡ªåŠ¨æ‰§è¡Œï¼š
  1. å®‰è£…ä¾èµ–
  2. æ„å»ºé¡¹ç›®
  3. è¿è¡Œéƒ¨ç½²æ£€æŸ¥
  4. éƒ¨ç½²åˆ° Cloudflare Pages

**éœ€è¦è®¾ç½®çš„ GitHub Secrets**ï¼š
- `CLOUDFLARE_API_TOKEN`
- `CLOUDFLARE_ACCOUNT_ID`

---

### 5. **æ–‡æ¡£**

#### `CLOUDFLARE_DEPLOYMENT.md`
- è¯¦ç»†çš„éƒ¨ç½²æŒ‡å—
- 3 ç§éƒ¨ç½²æ–¹å¼ï¼š
  1. é€šè¿‡ Git è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰
  2. é€šè¿‡ GitHub Actions
  3. é€šè¿‡ Wrangler CLI
- å¸¸è§é—®é¢˜è§£ç­”
- æ€§èƒ½ä¼˜åŒ–è¯´æ˜

#### `DEPLOYMENT_QUICKSTART.md`
- å¿«é€Ÿå…¥é—¨æŒ‡å—
- 3 æ­¥éƒ¨ç½²æµç¨‹
- æœ‰ç”¨å‘½ä»¤åˆ—è¡¨
- é«˜çº§é…ç½®é€‰é¡¹

#### `README.md`ï¼ˆå·²æ›´æ–°ï¼‰
- æ·»åŠ äº† Cloudflare Pages éƒ¨ç½²ç« èŠ‚
- åŒ…å«å¿«é€Ÿéƒ¨ç½²è¯´æ˜
- é“¾æ¥åˆ°è¯¦ç»†æ–‡æ¡£

---

## ğŸ“ æ›´æ–°çš„æ–‡ä»¶

### `package.json`
æ·»åŠ äº† 3 ä¸ªæ–°çš„ npm è„šæœ¬ï¼š
```json
{
  "scripts": {
    "deploy:check": "node scripts/pre-deploy-check.js",
    "deploy:preview": "wrangler pages deploy dist --project-name=pdftoolkit",
    "deploy:production": "wrangler pages deploy dist --project-name=pdftoolkit --branch=main"
  }
}
```

---

## ğŸ¯ å…³äºæ‚¨çœ‹åˆ°çš„"é”™è¯¯"

æ‚¨åœ¨ Cloudflare æ„å»ºæ—¥å¿—ä¸­çœ‹åˆ°çš„ **ä¸æ˜¯é”™è¯¯**ï¼Œè€Œæ˜¯ **è­¦å‘Šä¿¡æ¯**ã€‚

### âœ… è¿™äº›æ˜¯æ­£å¸¸çš„ï¼š

1. **Module externalized warnings**
   ```
   Module "fs", "path", "crypto" has been externalized
   ```
   - **åŸå› **ï¼šè¿™äº›æ˜¯ Node.js æ¨¡å—ï¼Œä¸èƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ
   - **å½±å“**ï¼šæ— å½±å“ï¼ŒVite è‡ªåŠ¨å¤„ç†
   - **çŠ¶æ€**ï¼šâœ… æ­£å¸¸

2. **Chunk size warnings**
   ```
   Some chunks are larger than 500 kB
   ```
   - **åŸå› **ï¼šPDF å¤„ç†åº“ï¼ˆpdf-lib, pdfjs-distï¼‰ä½“ç§¯è¾ƒå¤§
   - **å½±å“**ï¼šæ— å½±å“ï¼Œå·²ä¼˜åŒ–åˆ° 4MB é™åˆ¶
   - **çŠ¶æ€**ï¼šâœ… æ­£å¸¸

3. **npm deprecated warnings**
   ```
   npm warn deprecated ...
   ```
   - **åŸå› **ï¼šä¸€äº›ä¾èµ–åŒ…ä½¿ç”¨äº†è¿‡æ—¶çš„åº“
   - **å½±å“**ï¼šä¸å½±å“ç”Ÿäº§ç¯å¢ƒåŠŸèƒ½
   - **çŠ¶æ€**ï¼šâœ… å¯å¿½ç•¥

### âœ… æ„å»ºæˆåŠŸçš„æ ‡å¿—ï¼š

```
âœ“ 2031 modules transformed.
âœ“ built in 7.64s
```

**è¿™è¡¨ç¤ºæ„å»ºå·²ç»æˆåŠŸï¼** æ‚¨çš„é¡¹ç›®å¯ä»¥æ­£å¸¸éƒ¨ç½²ã€‚

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤ï¼ˆç®€åŒ–ç‰ˆï¼‰

### æœ€ç®€å•çš„æ–¹å¼ï¼š

1. **æ¨é€åˆ° Git**
   ```bash
   git add .
   git commit -m "Ready for deployment"
   git push origin main
   ```

2. **è¿æ¥ Cloudflare Pages**
   - è®¿é—® https://dash.cloudflare.com/
   - Pages â†’ Create a project
   - é€‰æ‹©æ‚¨çš„ä»“åº“
   - Cloudflare è‡ªåŠ¨æ£€æµ‹é…ç½®
   - ç‚¹å‡» Deploy

3. **å®Œæˆï¼**
   - ç­‰å¾… 3-5 åˆ†é’Ÿ
   - è·å¾—ä¸€ä¸ª `*.pages.dev` åŸŸå
   - æ”¯æŒè‡ªå®šä¹‰åŸŸå

---

## ğŸ”§ éªŒè¯éƒ¨ç½²å‡†å¤‡

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®è®¤ä¸€åˆ‡å°±ç»ªï¼š

```bash
npm run deploy:check
```

**é¢„æœŸè¾“å‡º**ï¼š
```
ğŸ‰ All checks passed! Your project is ready for deployment.
```

---

## ğŸ“Š æ€§èƒ½ç‰¹æ€§ï¼ˆå·²é…ç½®ï¼‰

| ç‰¹æ€§ | çŠ¶æ€ |
|------|------|
| å…¨çƒ CDN | âœ… 200+ èŠ‚ç‚¹ |
| è‡ªåŠ¨ HTTPS | âœ… å…è´¹ SSL è¯ä¹¦ |
| HTTP/2 & HTTP/3 | âœ… è‡ªåŠ¨å¯ç”¨ |
| Gzip/Brotli å‹ç¼© | âœ… è‡ªåŠ¨å‹ç¼© |
| é™æ€èµ„æºç¼“å­˜ | âœ… 1 å¹´ç¼“å­˜ |
| ä»£ç åˆ†å‰² | âœ… Manual chunks |
| å®‰å…¨ Headers | âœ… CORS, XSS, CSP |
| è‡ªå®šä¹‰åŸŸå | âœ… æ”¯æŒ |
| è‡ªåŠ¨éƒ¨ç½² | âœ… Git push è§¦å‘ |

---

## â“ æ‚¨ä¸éœ€è¦åšä»»ä½•é¢å¤–é…ç½®

**ä»¥ä¸‹å·²è‡ªåŠ¨å¤„ç†**ï¼š
- âœ… Node.js ç‰ˆæœ¬ï¼ˆé€šè¿‡ .nvmrcï¼‰
- âœ… æ„å»ºå‘½ä»¤ï¼ˆnpm run buildï¼‰
- âœ… è¾“å‡ºç›®å½•ï¼ˆdist/ï¼‰
- âœ… å®‰å…¨ Headersï¼ˆ_headers æ–‡ä»¶ï¼‰
- âœ… 404 å¤„ç†ï¼ˆ_redirects æ–‡ä»¶ï¼‰
- âœ… ç¼“å­˜ç­–ç•¥ï¼ˆå·²ä¼˜åŒ–ï¼‰
- âœ… å›½é™…åŒ–ï¼ˆ6 ç§è¯­è¨€ï¼‰
- âœ… å“ç‰Œæ›´æ–°ï¼ˆPDFToolkitï¼‰

**æ‚¨åªéœ€è¦**ï¼š
1. æ¨é€ä»£ç åˆ° Git
2. åœ¨ Cloudflare è¿æ¥ä»“åº“
3. ç‚¹å‡»éƒ¨ç½²æŒ‰é’®

---

## ğŸ‰ æ€»ç»“

### æ‚¨çš„é¡¹ç›®çŠ¶æ€ï¼š
- âœ… **æ„å»ºæˆåŠŸ**ï¼ˆæ— é”™è¯¯ï¼Œä»…è­¦å‘Šï¼‰
- âœ… **é…ç½®å®Œæ•´**ï¼ˆæ‰€æœ‰å¿…è¦æ–‡ä»¶å·²åˆ›å»ºï¼‰
- âœ… **æµ‹è¯•é€šè¿‡**ï¼ˆdeploy:check éªŒè¯æˆåŠŸï¼‰
- âœ… **å‡†å¤‡å°±ç»ª**ï¼ˆå¯ä»¥ç«‹å³éƒ¨ç½²ï¼‰

### ä¸‹ä¸€æ­¥ï¼š
1. é˜…è¯» [DEPLOYMENT_QUICKSTART.md](DEPLOYMENT_QUICKSTART.md)ï¼ˆ3 åˆ†é’Ÿå¿«é€Ÿå…¥é—¨ï¼‰
2. æˆ–æŸ¥çœ‹ [CLOUDFLARE_DEPLOYMENT.md](CLOUDFLARE_DEPLOYMENT.md)ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰
3. è¿è¡Œ `npm run deploy:check` éªŒè¯
4. æ¨é€ä»£ç å¹¶è¿æ¥ Cloudflare Pages

---

**ğŸŠ æ­å–œï¼æ‚¨çš„ PDFToolkit å·²å®Œå…¨å‡†å¤‡å¥½éƒ¨ç½²åˆ° Cloudflare Pagesï¼**

**æ²¡æœ‰é”™è¯¯ï¼Œåªæœ‰æˆåŠŸï¼** ğŸš€

